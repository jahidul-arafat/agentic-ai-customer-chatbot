
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Query Execution Graph - query_1750575476_b7e08b3f</title>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
        }
        
        .header {
            background: linear-gradient(135deg, #b8c6d1 0%, #c7d2dd 100%);
            color: black;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .header h1 {
            margin: 0 0 10px 0;
            font-size: 24px;
        }
        
        .metadata {
            display: flex;
            gap: 30px;
            flex-wrap: wrap;
        }
        
        .metadata div {
            background: rgba(255,255,255,0.2);
            padding: 10px 15px;
            border-radius: 5px;
        }
        
        .controls {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .controls button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 8px 16px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .controls button:hover {
            background: #45a049;
        }
        
        #network {
            width: 100%;
            height: 70vh;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .legend {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .legend h3 {
            margin-top: 0;
        }
        
        .legend-item {
            display: inline-block;
            margin: 5px 15px 5px 0;
        }
        
        .legend-color {
            display: inline-block;
            width: 20px;
            height: 20px;
            border-radius: 10px;
            margin-right: 8px;
            vertical-align: middle;
        }
        
        .legend-line {
            display: inline-block;
            width: 30px;
            height: 3px;
            margin-right: 8px;
            vertical-align: middle;
            border-radius: 1px;
        }
        
        .info-panel {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .info-panel h3 {
            margin-top: 0;
            color: #333;
        }
        
        .node-details {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
            border-left: 4px solid #007bff;
        }
        
        .detail-section {
            margin: 15px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 5px;
            border-left: 4px solid #007bff;
        }

        .detail-section h5 {
            margin: 0 0 10px 0;
            color: #495057;
            font-size: 14px;
        }

        .detail-table {
            width: 100%;
            border-collapse: collapse;
            margin: 5px 0;
        }

        .detail-table td {
            padding: 4px 8px;
            border-bottom: 1px solid #dee2e6;
            font-size: 13px;
        }

        .detail-table td:first-child {
            width: 40%;
            color: #6c757d;
        }

        .status-completed { color: #28a745; font-weight: bold; }
        .status-failed { color: #dc3545; font-weight: bold; }
        .status-in_progress { color: #ffc107; font-weight: bold; }
        .status-pending { color: #6c757d; font-weight: bold; }
        .status-cached { color: #17a2b8; font-weight: bold; }
        
        .query-response-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .query-box, .response-box {
            background: rgba(255,255,255,0.15);
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #4CAF50;
        }

        .query-box h3, .response-box h3 {
            margin: 0 0 10px 0;
            font-size: 16px;
            color: black;
        }

        .query-box p, .response-box p {
            margin: 0;
            font-size: 14px;
            line-height: 1.4;
            color: black;
        }

        .shadow-node {
            opacity: 0.7;
            border: 2px dashed #666;
            background: rgba(255,255,255,0.9);
            font-style: italic;
        }

        .shadow-edge {
            opacity: 0.5;
            dashes: [5, 5];
            color: #999;
        }

        /* Animation for shadow nodes */
        @keyframes shadowFadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 0.7; transform: translateY(0); }
        }

        .shadow-node {
            animation: shadowFadeIn 0.3s ease-out;
        }
        
        /* Developer Information and Tool Description Styles */
        .developer-info {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin: 20px 0;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .developer-badge {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            min-width: 250px;
        }
        
        .developer-badge h4 {
            margin: 0 0 8px 0;
            color: black;
            font-size: 14px;
        }
        
        .developer-link {
            color: black;
            text-decoration: none;
            font-size: 16px;
            line-height: 1.4;
            transition: all 0.3s ease;
        }
        
        .developer-link:hover {
            color: #a8e6cf;
            text-shadow: 0 0 8px rgba(168, 230, 207, 0.8);
        }
        
        .tool-description {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            flex: 1;
            min-width: 300px;
        }
        
        .tool-description h4 {
            margin: 0 0 8px 0;
            color: black;
            font-size: 14px;
        }
        
        .tool-description p {
            margin: 0;
            font-size: 13px;
            line-height: 1.5;
            color: black;
        }
        
        /* Responsive Design for Mobile */
        @media (max-width: 768px) {
                .developer-info {
                flex-direction: column;
                gap: 15px;
                }
        
                .developer-badge,
                .tool-description {
                min-width: unset;
                width: 100%;
                }
        
                .tool-description p {
                font-size: 12px;
                }
            }
            
        .callgraph-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .network-column {
                display: flex;
            flex-direction: column;
        }
        
        .execution-image-column {
                display: flex;
            flex-direction: column;
        }
        
        #network {
                width: 100%;
            height: 70vh;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .execution-image {
                width: 100%;
            height: 70vh;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            object-fit: contain;
            padding: 10px;
            box-sizing: border-box;
        }
        
        .column-header {
                background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            text-align: center;
            font-weight: bold;
            color: #333;
        }
        
        /* Responsive design for mobile */
        @media (max-width: 1024px) {
                .callgraph-container {
                grid-template-columns: 1fr;
                gap: 15px;
                }
        
                .execution-image {
                height: 50vh;
                }
                }
        
        .pseudocode-section {
                background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .pseudocode-section h3 {
                margin-top: 0;
            color: #333;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 10px;
        }
        
        .pseudocode-container {
                background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.4;
            max-height: 600px;
            overflow-y: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .pseudocode-container::before {
                content: "/**
 * CORE AGENTIC AI SYSTEM ALGORITHM
 * Autonomous Query Processing with Intelligent Tool Orchestration
 * 
 * Author: Jahidul Arafat (ex-L3 Sr Solution Architect, Oracle)
 * Presidential Fellow & PhD Candidate, Auburn University
 */";
            display: block;
            color: #28a745;
            font-weight: bold;
            margin-bottom: 15px;
            border-bottom: 1px solid #dee2e6;
            padding-bottom: 10px;
        }
        
        .pseudocode-highlight {
                background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
            padding: 15px;
            border-left: 4px solid #2196F3;
            margin: 10px 0;
            border-radius: 5px;
        }
        
        .toggle-pseudocode {
                background: #2196F3;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin-bottom: 15px;
            font-size: 14px;
        }
        
        .toggle-pseudocode:hover {
                background: #1976D2;
        }
        
        /* Syntax highlighting for pseudocode */
        .keyword { color: #d73a49; font-weight: bold; }
        .function-name { color: #6f42c1; font-weight: bold; }
        .comment { color: #6a737d; font-style: italic; }
        .string { color: #032f62; }
        .number { color: #005cc5; }
        .variable { color: #e36209; }
    </style>
</head>
<body>
    <div class="header">
        <h1>🎯 Enhanced Agentic AI (LLM+Vector Embedding) Query/Goal Execution Call Graph (Autonomous with Intelligent Routing)</h1>
        <p><a href="https://www.linkedin.com/in/jahidul-arafat-presidential-fellow-phd-candidate-791a7490/" target="_blank" class="developer-link">
            <strong>Algorithm and Simulation Designed By Jahidul Arafat (ex-L3 Sr Solution and Cloud Architect, Oracle)</strong><br>
            Presidential Fellow & PhD Candidate, Auburn University (R1 Carnegie Research University), USA
        </a></p>

        
        <div class="query-response-section">
            <div class="query-box">
                <h3>📝 Original Query:</h3>
                <p><strong>Why hasn't order 1005 been delivered yet? Check the status and compare with similar orders from the same timeframe</strong></p>
            </div>
            <div class="response-box">
                <h3>✅ Final Response:</h3>
                <p><strong>The reason why order 1005 has not been delivered yet could be due to delays in processing caused by high demand or supply chain disruptions for the Gaming Monitor 32" ASUS, as there are no system-wide issues and the order is still in processing status. I recommend checking with the customer service ...</strong></p>
            </div>
        </div>
        
        <div class="metadata">
            <div><strong>Query ID:</strong> query_1750575476_b7e08b3f</div>
            <div><strong>Generated:</strong> 2025-06-22T02:06:53.342102</div>
            <div><strong>Nodes:</strong> 15</div>
            <div><strong>Edges:</strong> 14</div>
            <div><strong>Total Time:</strong> 536.46s</div>
        </div>
    </div>
    
    <div class="controls">
        <button onclick="fitNetwork()">🔍 Fit to Screen</button>
        <button onclick="togglePhysics()">⚡ Toggle Physics</button>
        <button onclick="exportImage()">📷 Export Image</button>
        <button onclick="showStatistics()">📊 Show Statistics</button>
        <button onclick="resetView()">🔄 Reset View</button>
        <button onclick="highlightActions()">🎯 Highlight Actions</button>
    </div>
    
    <div class="pseudocode-section">
    <h3>🧠 Core Agentic AI Algorithm Pseudocode</h3>
    <button class="toggle-pseudocode" onclick="togglePseudocode()">📖 Show/Hide Algorithm Details</button>
    
    <div id="pseudocode-content" style="display: none;">
        <div class="pseudocode-highlight">
            <strong>Algorithm Overview:</strong> This pseudocode represents the core autonomous AI agent that processes queries through intelligent reasoning, tool selection, execution, and response synthesis.
        </div>
        
        <div class="pseudocode-container">
            <span class="comment">// ===== INITIALIZATION PHASE =====</span>
            <span class="keyword">ALGORITHM</span> <span class="function-name">AgenticAI_QueryProcessor</span>
            
            <span class="keyword">INITIALIZE</span> <span class="function-name">AgentSystem</span>:
                <span class="keyword">SET</span> <span class="variable">available_tools</span> = [get_order_items, get_item_return_days, database_query, cache_manager, ...]
                <span class="keyword">SET</span> <span class="variable">reasoning_engine</span> = <span class="function-name">NeuralReasoningModule</span>()
                <span class="keyword">SET</span> <span class="variable">cache_system</span> = <span class="function-name">IntelligentCache</span>()
                <span class="keyword">SET</span> <span class="variable">error_handler</span> = <span class="function-name">AdaptiveErrorRecovery</span>()
                <span class="keyword">SET</span> <span class="variable">execution_graph</span> = <span class="function-name">CallGraph</span>()
            
            <span class="comment">// ===== MAIN PROCESSING LOOP =====</span>
            <span class="keyword">FUNCTION</span> <span class="function-name">ProcessQuery</span>(user_query):
                
                <span class="comment">// Phase 1: Query Reception and Initial Analysis</span>
                <span class="keyword">CREATE</span> <span class="variable">node_start</span> = <span class="function-name">QueryStartNode</span>(user_query, timestamp=<span class="function-name">NOW</span>())
                <span class="keyword">ADD</span> <span class="variable">node_start</span> <span class="keyword">TO</span> <span class="variable">execution_graph</span>
                
                <span class="comment">// Phase 2: AI Thinking and Context Analysis</span>
                <span class="variable">thinking_node</span> = <span class="keyword">CREATE</span> <span class="function-name">ThinkingNode</span>()
                <span class="variable">reasoning_context</span> = <span class="function-name">ANALYZE_QUERY_CONTEXT</span>(user_query)
                
                <span class="keyword">WHILE</span> reasoning_incomplete:
                    <span class="variable">thought_process</span> = reasoning_engine.<span class="function-name">THINK</span>(
                        query=user_query,
                        context=reasoning_context,
                        available_tools=available_tools
                    )
                    
                    <span class="keyword">ADD</span> <span class="function-name">ThinkingNode</span>(thought_process) <span class="keyword">TO</span> <span class="variable">execution_graph</span>
                    
                    <span class="keyword">IF</span> thought_process.confidence > <span class="variable">CONFIDENCE_THRESHOLD</span>:
                        <span class="keyword">BREAK</span> reasoning_loop
                
                <span class="comment">// Phase 3: Tool Selection and Action Planning</span>
                <span class="variable">selected_actions</span> = <span class="function-name">INTELLIGENT_TOOL_SELECTION</span>(
                    query=user_query,
                    context=reasoning_context,
                    tools=available_tools
                )
                
                <span class="comment">// Phase 4: Sequential Action Execution with Dynamic Routing</span>
                <span class="variable">execution_results</span> = []
                
                <span class="keyword">FOR EACH</span> action <span class="keyword">IN</span> selected_actions:
                    
                    <span class="comment">// Check cache first (optimization)</span>
                    <span class="variable">cache_key</span> = <span class="function-name">GENERATE_CACHE_KEY</span>(action.name, action.parameters)
                    
                    <span class="keyword">IF</span> cache_system.<span class="function-name">HAS_CACHED_RESULT</span>(cache_key):
                        <span class="variable">cache_node</span> = <span class="keyword">CREATE</span> <span class="function-name">CacheHitNode</span>(action.name, cache_key)
                        <span class="variable">result</span> = cache_system.<span class="function-name">GET_CACHED_RESULT</span>(cache_key)
                        <span class="keyword">ADD</span> <span class="variable">cache_node</span> <span class="keyword">TO</span> <span class="variable">execution_graph</span>
                        
                        <span class="comment">// Logical inference on cached result</span>
                        <span class="variable">inference_node</span> = <span class="keyword">CREATE</span> <span class="function-name">LogicalInferenceNode</span>(
                            reasoning=<span class="string">"Cache hit - data retrieved instantly"</span>,
                            evidence=result,
                            conclusion=<span class="string">"Saved execution time"</span>
                        )
                        <span class="keyword">ADD</span> <span class="variable">inference_node</span> <span class="keyword">TO</span> <span class="variable">execution_graph</span>
                        <span class="keyword">CONNECT</span> <span class="variable">cache_node</span> <span class="keyword">TO</span> <span class="variable">inference_node</span>
                        
                    <span class="keyword">ELSE</span>:
                        <span class="comment">// Execute action</span>
                        <span class="variable">execution_node</span> = <span class="keyword">CREATE</span> <span class="function-name">ActionExecutionNode</span>(action.name)
                        <span class="function-name">START_TIMER</span>()
                        
                        <span class="keyword">TRY</span>:
                            <span class="variable">result</span> = <span class="function-name">EXECUTE_ACTION</span>(action.name, action.parameters)
                            <span class="variable">execution_time</span> = <span class="function-name">STOP_TIMER</span>()
                            
                            execution_node.<span class="function-name">SET_RESULT</span>(result, execution_time)
                            execution_node.<span class="function-name">SET_STATUS</span>(<span class="string">"completed"</span>)
                            
                            <span class="comment">// Cache successful results</span>
                            cache_system.<span class="function-name">STORE_RESULT</span>(cache_key, result)
                            
                        <span class="keyword">CATCH</span> error:
                            <span class="comment">// Error handling and recovery</span>
                            <span class="variable">error_node</span> = <span class="keyword">CREATE</span> <span class="function-name">ErrorNode</span>(error.type, error.message)
                            <span class="keyword">ADD</span> <span class="variable">error_node</span> <span class="keyword">TO</span> <span class="variable">execution_graph</span>
                            <span class="keyword">CONNECT</span> <span class="variable">execution_node</span> <span class="keyword">TO</span> <span class="variable">error_node</span>
                            
                            <span class="comment">// Attempt recovery or alternative routing</span>
                            <span class="variable">recovery_result</span> = error_handler.<span class="function-name">ATTEMPT_RECOVERY</span>(action, error)
                            <span class="keyword">IF</span> recovery_result.success:
                                <span class="variable">result</span> = recovery_result.data
                            <span class="keyword">ELSE</span>:
                                <span class="comment">// Continue with partial results or fallback</span>
                                <span class="variable">result</span> = <span class="function-name">FALLBACK_STRATEGY</span>(action, error)
                        
                        <span class="keyword">ADD</span> <span class="variable">execution_node</span> <span class="keyword">TO</span> <span class="variable">execution_graph</span>
                        
                        <span class="comment">// Logical inference on execution result</span>
                        <span class="keyword">IF</span> result.success:
                            <span class="variable">inference_node</span> = <span class="keyword">CREATE</span> <span class="function-name">LogicalInferenceNode</span>(
                                reasoning=f<span class="string">"Tool {action.name} returned {result.record_count} items"</span>,
                                evidence=result.data,
                                conclusion=<span class="string">"Successfully retrieved records"</span>
                            )
                            <span class="keyword">ADD</span> <span class="variable">inference_node</span> <span class="keyword">TO</span> <span class="variable">execution_graph</span>
                            <span class="keyword">CONNECT</span> <span class="variable">execution_node</span> <span class="keyword">TO</span> <span class="variable">inference_node</span>
                    
                    execution_results.<span class="function-name">APPEND</span>(result)
                    
                    <span class="comment">// Dynamic routing: decide next action based on current results</span>
                    <span class="variable">next_actions</span> = <span class="function-name">ADAPTIVE_ROUTING</span>(
                        current_results=execution_results,
                        remaining_actions=selected_actions,
                        query_context=reasoning_context
                    )
                    
                    <span class="keyword">IF</span> next_actions.requires_modification:
                        <span class="variable">selected_actions</span> = <span class="function-name">UPDATE_ACTION_PLAN</span>(selected_actions, next_actions)
                
                <span class="comment">// Phase 5: Result Synthesis and Response Generation</span>
                <span class="variable">synthesis_thinking</span> = <span class="keyword">CREATE</span> <span class="function-name">ThinkingNode</span>(
                    thought=<span class="string">"Query processing completed successfully"</span>,
                    context=f<span class="string">"Generated response based on {LEN(execution_results)} results"</span>
                )
                <span class="keyword">ADD</span> <span class="variable">synthesis_thinking</span> <span class="keyword">TO</span> <span class="variable">execution_graph</span>
                
                <span class="variable">final_response</span> = <span class="function-name">SYNTHESIZE_RESPONSE</span>(
                    query=user_query,
                    execution_results=execution_results,
                    reasoning_context=reasoning_context
                )
                
                <span class="comment">// Phase 6: Final Response Delivery</span>
                <span class="variable">response_node</span> = <span class="keyword">CREATE</span> <span class="function-name">FinalResponseNode</span>(final_response)
                <span class="keyword">ADD</span> <span class="variable">response_node</span> <span class="keyword">TO</span> <span class="variable">execution_graph</span>
                <span class="keyword">CONNECT</span> <span class="variable">synthesis_thinking</span> <span class="keyword">TO</span> <span class="variable">response_node</span>
                
                <span class="keyword">RETURN</span> final_response, execution_graph
            
            <span class="comment">// ===== SUPPORTING ALGORITHMS =====</span>
            
            <span class="keyword">FUNCTION</span> <span class="function-name">INTELLIGENT_TOOL_SELECTION</span>(query, context, tools):
                <span class="comment">// Vector similarity matching + semantic analysis</span>
                <span class="variable">query_embedding</span> = <span class="function-name">EMBED_QUERY</span>(query)
                <span class="variable">tool_scores</span> = []
                
                <span class="keyword">FOR EACH</span> tool <span class="keyword">IN</span> tools:
                    <span class="variable">tool_embedding</span> = <span class="function-name">EMBED_TOOL_DESCRIPTION</span>(tool)
                    <span class="variable">similarity_score</span> = <span class="function-name">COSINE_SIMILARITY</span>(query_embedding, tool_embedding)
                    <span class="variable">context_relevance</span> = <span class="function-name">CALCULATE_CONTEXT_RELEVANCE</span>(tool, context)
                    
                    <span class="variable">final_score</span> = similarity_score * <span class="number">0.7</span> + context_relevance * <span class="number">0.3</span>
                    tool_scores.<span class="function-name">APPEND</span>((tool, final_score))
                
                <span class="comment">// Select top-k tools based on confidence threshold</span>
                <span class="variable">selected_tools</span> = <span class="function-name">FILTER</span>(tool_scores, score > <span class="variable">SELECTION_THRESHOLD</span>)
                <span class="keyword">RETURN</span> <span class="function-name">SORT</span>(selected_tools, BY=score, DESCENDING=True)
            
            <span class="keyword">FUNCTION</span> <span class="function-name">ADAPTIVE_ROUTING</span>(current_results, remaining_actions, query_context):
                <span class="comment">// Dynamic decision making based on intermediate results</span>
                <span class="variable">confidence_level</span> = <span class="function-name">CALCULATE_CONFIDENCE</span>(current_results)
                <span class="variable">completeness_score</span> = <span class="function-name">ASSESS_COMPLETENESS</span>(current_results, query_context)
                
                <span class="keyword">IF</span> confidence_level > <span class="number">0.9</span> <span class="keyword">AND</span> completeness_score > <span class="number">0.8</span>:
                    <span class="keyword">RETURN</span> <span class="function-name">EarlyTermination</span>(reason=<span class="string">"Sufficient information gathered"</span>)
                
                <span class="keyword">IF</span> confidence_level < <span class="number">0.3</span>:
                    <span class="variable">additional_tools</span> = <span class="function-name">SUGGEST_ALTERNATIVE_TOOLS</span>(query_context, current_results)
                    <span class="keyword">RETURN</span> <span class="function-name">ModifiedPlan</span>(additional_tools)
                
                <span class="keyword">RETURN</span> <span class="function-name">ContinueExecution</span>()
            
            <span class="keyword">FUNCTION</span> <span class="function-name">SYNTHESIZE_RESPONSE</span>(query, execution_results, reasoning_context):
                <span class="comment">// Advanced response generation using LLM capabilities</span>
                <span class="variable">successful_results</span> = <span class="function-name">FILTER</span>(execution_results, result.success == True)
                
                <span class="keyword">IF</span> <span class="function-name">EMPTY</span>(successful_results):
                    <span class="keyword">RETURN</span> <span class="function-name">GENERATE_FALLBACK_RESPONSE</span>(query, reasoning_context)
                
                <span class="comment">// Combine multiple data sources intelligently</span>
                <span class="variable">combined_data</span> = <span class="function-name">MERGE_RESULTS</span>(successful_results)
                
                <span class="comment">// Generate natural language response</span>
                <span class="variable">response</span> = <span class="function-name">LLM_GENERATE_RESPONSE</span>(
                    template=<span class="string">"Based on the query '{query}', here's what I found: {data}"</span>,
                    query=query,
                    data=combined_data,
                    tone=<span class="string">"professional"</span>,
                    format=<span class="string">"customer_service"</span>
                )
                
                <span class="keyword">RETURN</span> response
            
            <span class="comment">// ===== MAIN EXECUTION ENTRY POINT =====</span>
            <span class="keyword">MAIN</span>:
                <span class="variable">user_query</span> = <span class="string">"What is the return policy for order number 1001?"</span>
                
                <span class="variable">agent_system</span> = <span class="keyword">INITIALIZE</span> <span class="function-name">AgentSystem</span>()
                <span class="variable">response</span>, <span class="variable">call_graph</span> = agent_system.<span class="function-name">ProcessQuery</span>(user_query)
                
                <span class="function-name">VISUALIZE_EXECUTION_GRAPH</span>(call_graph)
                <span class="function-name">DISPLAY_RESPONSE</span>(response)
                
                <span class="variable">performance_metrics</span> = <span class="function-name">CALCULATE_PERFORMANCE_METRICS</span>(call_graph)
                <span class="function-name">LOG_METRICS</span>(performance_metrics)
            
            <span class="keyword">END ALGORITHM</span>
                    </div>
                    
                    <div class="pseudocode-highlight">
                        <strong>Key Features:</strong>
                        <ul>
                            <li><strong>Autonomous Reasoning:</strong> Multi-phase thinking and context analysis</li>
                            <li><strong>Intelligent Tool Selection:</strong> Vector similarity + semantic analysis</li>
                            <li><strong>Dynamic Routing:</strong> Adaptive decision making based on intermediate results</li>
                            <li><strong>Cache Optimization:</strong> Intelligent caching with performance tracking</li>
                            <li><strong>Error Recovery:</strong> Multiple recovery strategies for fault tolerance</li>
                            <li><strong>Execution Transparency:</strong> Complete call graph generation for analysis</li>
                        </ul>
                    </div>
                </div>
            </div>

    <div class="legend">
        <h3>🎨 Node Types Legend</h3>
        <div class="legend-item"><span class="legend-color" style="background: #4CAF50;"></span>Query Start/Final Response</div>
        <div class="legend-item"><span class="legend-color" style="background: #2196F3;"></span>Thinking Process</div>
        <div class="legend-item"><span class="legend-color" style="background: #673AB7;"></span>Action Selection</div>
        <div class="legend-item"><span class="legend-color" style="background: #3F51B5;"></span>Action Execution</div>
        <div class="legend-item"><span class="legend-color" style="background: #00BCD4;"></span>Cache Hit</div>
        <div class="legend-item"><span class="legend-color" style="background: #FF9800;"></span>Decomposition</div>
        <div class="legend-item"><span class="legend-color" style="background: #607D8B;"></span>Logical Inference</div>
        <div class="legend-item"><span class="legend-color" style="background: #E91E63;"></span>Result Synthesis</div>
        <div class="legend-item"><span class="legend-color" style="background: #F44336;"></span>Error</div>
    </div>

    <div class="legend">
        <h3>🌈 Edge Types Legend</h3>
        <div class="legend-item"><span class="legend-line" style="background: #2196F3;"></span>Thinking Process</div>
        <div class="legend-item"><span class="legend-line" style="background: #607D8B;"></span>Logical Inference</div>
        <div class="legend-item"><span class="legend-line" style="background: #673AB7;"></span>Action Selection</div>
        <div class="legend-item"><span class="legend-line" style="background: #3F51B5;"></span>Action Execution</div>
        <div class="legend-item"><span class="legend-line" style="background: #00BCD4; border-style: dashed;"></span>Cache Hit</div>
        <div class="legend-item"><span class="legend-line" style="background: #4CAF50;"></span>Result Production</div>
        <div class="legend-item"><span class="legend-line" style="background: #F44336; border-style: dashed;"></span>Error Flow</div>
    </div>
    <br>
    
    <div class="callgraph-container">
        <div class="network-column">
            <div class="column-header">🎯 Interactive Call Graph Visualization</div>
            <div id="network">Test</div>
        </div>


        <div class="info-panel">
            <div class="column-header">📋 Enhanced Node Information</div>
            <div id="node-info">Click on a node to see comprehensive detailed information</div>
        </div>
    </div>
    

    
<!--    <div class="info-panel">-->
<!--        <h3>📋 Enhanced Node Information</h3>-->
<!--        <div id="node-info">Click on a node to see comprehensive detailed information</div>-->
<!--    </div>-->

    <div class="execution-image-column">
        <div class="column-header">📊 Detailed Execution Flow</div>
        <img src="image1.png" alt="Detailed Execution Flow" class="execution-image">
    </div>
    
    <script>
        // Graph data
        const graphData = {
  "nodes": [
    {
      "id": "query_start_0ccadcbb",
      "label": "Query Received",
      "title": "Node: Query Received\nType: query_start\nStatus: in_progress\nDescription: Initial query: Why hasnt order 1005 been delivered\nyet? Check the status and compare with similar\nor...\nInput: query: Why hasnt order 1005 been delivered yet?\nCheck the status and compare wit...",
      "color": {
        "background": "#FFE082",
        "border": "#FFA000"
      },
      "shape": "star",
      "font": {
        "size": 10,
        "color": "#333"
      },
      "size": 20,
      "physics": true,
      "widthConstraint": {
        "minimum": 100,
        "maximum": 150
      }
    },
    {
      "id": "thinking_834c33e4",
      "label": "AI Thinking Process",
      "title": "Node: AI Thinking Process\nType: thinking\nStatus: in_progress\nDescription: Reasoning: Customer service agent received query:\nWhy hasnt order 1005 been delivered yet? Check\nthe...\nInput: thought: Customer service agent received query:\nWhy hasnt order 1005 been delive...",
      "color": {
        "background": "#FFE082",
        "border": "#FFA000"
      },
      "shape": "ellipse",
      "font": {
        "size": 10,
        "color": "#333"
      },
      "size": 20,
      "physics": true,
      "widthConstraint": {
        "minimum": 100,
        "maximum": 150
      }
    },
    {
      "id": "thinking_becab4f7",
      "label": "AI Thinking Process",
      "title": "Node: AI Thinking Process\nType: thinking\nStatus: in_progress\nDescription: Reasoning: Received customer query, initializing\nresponse process\nInput: thought: Received customer query, initializing\nresponse process, context: Query ...",
      "color": {
        "background": "#FFE082",
        "border": "#FFA000"
      },
      "shape": "ellipse",
      "font": {
        "size": 10,
        "color": "#333"
      },
      "size": 20,
      "physics": true,
      "widthConstraint": {
        "minimum": 100,
        "maximum": 150
      }
    },
    {
      "id": "thinking_de2407fe",
      "label": "AI Thinking Process",
      "title": "Node: AI Thinking Process\nType: thinking\nStatus: in_progress\nDescription: Reasoning: Evaluating 16 available tools for this\nquery\nInput: thought: Evaluating 16 available tools for this\nquery, context: Analyzing query ...",
      "color": {
        "background": "#FFE082",
        "border": "#FFA000"
      },
      "shape": "ellipse",
      "font": {
        "size": 10,
        "color": "#333"
      },
      "size": 20,
      "physics": true,
      "widthConstraint": {
        "minimum": 100,
        "maximum": 150
      }
    },
    {
      "id": "thinking_c31f74ae",
      "label": "AI Thinking Process",
      "title": "Node: AI Thinking Process\nType: thinking\nStatus: in_progress\nDescription: Reasoning: Executing main agent query processing\nInput: thought: Executing main agent query processing,\ncontext: Agent will now process ...",
      "color": {
        "background": "#FFE082",
        "border": "#FFA000"
      },
      "shape": "ellipse",
      "font": {
        "size": 10,
        "color": "#333"
      },
      "size": 20,
      "physics": true,
      "widthConstraint": {
        "minimum": 100,
        "maximum": 150
      }
    },
    {
      "id": "action_execution_c71c2e23",
      "label": "Execute: get_delivery_...",
      "title": "Node: Execute: get_delivery_date\nType: action_execution\nStatus: completed\nDescription: Running get_delivery_date with parameters: args:\n(), kwargs:\nExecution Time: 0.087s\nInput: action_name: get_delivery_date, parameters: args:\n(), kwargs: , cached: False\nOutput: result: 15-Jun, success: True",
      "color": {
        "background": "#3F51B5",
        "border": "#3F51B5"
      },
      "shape": "square",
      "font": {
        "size": 10,
        "color": "#333"
      },
      "size": 20,
      "physics": true,
      "widthConstraint": {
        "minimum": 100,
        "maximum": 150
      }
    },
    {
      "id": "action_execution_2426aab8",
      "label": "Execute: analyze_order...",
      "title": "Node: Execute: analyze_orders_by_status_and_timeframe\nType: action_execution\nStatus: completed\nDescription: Running analyze_orders_by_status_and_timeframe\nwith parameters: args: (16-Jun,), kwargs:\nExecution Time: 0.003s\nInput: action_name:\nanalyze_orders_by_status_and_timeframe,\nparameters: args: (16-Jun,)...\nOutput: result: timeframe: 14-Jun to 16-Jun,\nstatus_breakdown: [], total_orders: 0, tota...",
      "color": {
        "background": "#3F51B5",
        "border": "#3F51B5"
      },
      "shape": "square",
      "font": {
        "size": 10,
        "color": "#333"
      },
      "size": 20,
      "physics": true,
      "widthConstraint": {
        "minimum": 100,
        "maximum": 150
      }
    },
    {
      "id": "logical_inference_3a30288b",
      "label": "Logical Inference",
      "title": "Node: Logical Inference\nType: logical_inference\nStatus: completed\nDescription: Reasoning: Tool\nanalyze_orders_by_status_and_timeframe executed\nsuccessfully\nExecution Time: 0.000s\nInput: reasoning: Tool\nanalyze_orders_by_status_and_timeframe executed\nsuccessfully, ev...\nOutput: conclusion: Retrieved valid data: timeframe:\n14-Jun to 16-Jun, status_breakdown:...",
      "color": {
        "background": "#607D8B",
        "border": "#607D8B"
      },
      "shape": "hexagon",
      "font": {
        "size": 10,
        "color": "#333"
      },
      "size": 20,
      "physics": true,
      "widthConstraint": {
        "minimum": 100,
        "maximum": 150
      }
    },
    {
      "id": "error_f4a614d2",
      "label": "Error: timeout",
      "title": "Node: Error: timeout\nType: error\nStatus: failed\nDescription: Error occurred: Query execution timeout\nExecution Time: 0.000s\nInput: error_message: Query execution timeout,\nerror_type: timeout\nOutput: error: Query execution timeout",
      "color": {
        "background": "#F44336",
        "border": "#D32F2F"
      },
      "shape": "triangleDown",
      "font": {
        "size": 10,
        "color": "#333"
      },
      "size": 20,
      "physics": true,
      "widthConstraint": {
        "minimum": 100,
        "maximum": 150
      }
    },
    {
      "id": "action_execution_2268839e",
      "label": "Execute: get_order_det...",
      "title": "Node: Execute: get_order_details\nType: action_execution\nStatus: completed\nDescription: Running get_order_details with parameters: args:\n(), kwargs:\nExecution Time: 0.007s\nInput: action_name: get_order_details, parameters: args:\n(), kwargs: , cached: False\nOutput: result: order_id: 1005, order_date:\ndatetime.date(2024, 6, 10), delivery_date: d...",
      "color": {
        "background": "#3F51B5",
        "border": "#3F51B5"
      },
      "shape": "square",
      "font": {
        "size": 10,
        "color": "#333"
      },
      "size": 20,
      "physics": true,
      "widthConstraint": {
        "minimum": 100,
        "maximum": 150
      }
    },
    {
      "id": "logical_inference_e2655c0d",
      "label": "Logical Inference",
      "title": "Node: Logical Inference\nType: logical_inference\nStatus: completed\nDescription: Reasoning: Tool get_order_details executed\nsuccessfully\nExecution Time: 0.000s\nInput: reasoning: Tool get_order_details executed\nsuccessfully, evidence: [Input: ()......\nOutput: conclusion: Retrieved valid data: order_id: 1005,\norder_date: datetime.date(2024...",
      "color": {
        "background": "#607D8B",
        "border": "#607D8B"
      },
      "shape": "hexagon",
      "font": {
        "size": 10,
        "color": "#333"
      },
      "size": 20,
      "physics": true,
      "widthConstraint": {
        "minimum": 100,
        "maximum": 150
      }
    },
    {
      "id": "action_execution_90b6aba9",
      "label": "Execute: get_order_items",
      "title": "Node: Execute: get_order_items\nType: action_execution\nStatus: completed\nDescription: Running get_order_items with parameters: args: (),\nkwargs:\nExecution Time: 0.008s\nInput: action_name: get_order_items, parameters: args:\n(), kwargs: , cached: False\nOutput: result: [\\Gaming Monitor 32 ASUS\\], success: True",
      "color": {
        "background": "#3F51B5",
        "border": "#3F51B5"
      },
      "shape": "square",
      "font": {
        "size": 10,
        "color": "#333"
      },
      "size": 20,
      "physics": true,
      "widthConstraint": {
        "minimum": 100,
        "maximum": 150
      }
    },
    {
      "id": "logical_inference_98a1b03c",
      "label": "Logical Inference",
      "title": "Node: Logical Inference\nType: logical_inference\nStatus: completed\nDescription: Reasoning: Tool get_order_items returned 1 items\nExecution Time: 0.000s\nInput: reasoning: Tool get_order_items returned 1 items,\nevidence: [Query parameters: (...\nOutput: conclusion: Successfully retrieved 1 records",
      "color": {
        "background": "#607D8B",
        "border": "#607D8B"
      },
      "shape": "hexagon",
      "font": {
        "size": 10,
        "color": "#333"
      },
      "size": 20,
      "physics": true,
      "widthConstraint": {
        "minimum": 100,
        "maximum": 150
      }
    },
    {
      "id": "thinking_f0741344",
      "label": "AI Thinking Process",
      "title": "Node: AI Thinking Process\nType: thinking\nStatus: in_progress\nDescription: Reasoning: Query processing completed successfully\nInput: thought: Query processing completed successfully,\ncontext: Generated response of...",
      "color": {
        "background": "#FFE082",
        "border": "#FFA000"
      },
      "shape": "ellipse",
      "font": {
        "size": 10,
        "color": "#333"
      },
      "size": 20,
      "physics": true,
      "widthConstraint": {
        "minimum": 100,
        "maximum": 150
      }
    },
    {
      "id": "final_response_be8a8e6d",
      "label": "Final Response",
      "title": "Node: Final Response\nType: final_response\nStatus: completed\nDescription: Query completed: The reason why order 1005 has not\nbeen delivered yet could be due to delays in\nproc...\nExecution Time: 0.000s\nInput: response: The reason why order 1005 has not been\ndelivered yet could be due to d...\nOutput: final_response: The reason why order 1005 has not\nbeen delivered yet could be du...",
      "color": {
        "background": "#4CAF50",
        "border": "#4CAF50"
      },
      "shape": "star",
      "font": {
        "size": 10,
        "color": "#333"
      },
      "size": 20,
      "physics": true,
      "widthConstraint": {
        "minimum": 100,
        "maximum": 150
      }
    }
  ],
  "edges": [
    {
      "from": "query_start_0ccadcbb",
      "to": "thinking_834c33e4",
      "label": "thinks",
      "arrows": "to",
      "font": {
        "size": 10
      },
      "color": {
        "color": "#2196F3"
      },
      "width": 2,
      "dashes": false,
      "smooth": {
        "type": "continuous"
      }
    },
    {
      "from": "thinking_834c33e4",
      "to": "thinking_becab4f7",
      "label": "thinks",
      "arrows": "to",
      "font": {
        "size": 10
      },
      "color": {
        "color": "#2196F3"
      },
      "width": 2,
      "dashes": false,
      "smooth": {
        "type": "continuous"
      }
    },
    {
      "from": "thinking_becab4f7",
      "to": "thinking_de2407fe",
      "label": "thinks",
      "arrows": "to",
      "font": {
        "size": 10
      },
      "color": {
        "color": "#2196F3"
      },
      "width": 2,
      "dashes": false,
      "smooth": {
        "type": "continuous"
      }
    },
    {
      "from": "thinking_de2407fe",
      "to": "thinking_c31f74ae",
      "label": "thinks",
      "arrows": "to",
      "font": {
        "size": 10
      },
      "color": {
        "color": "#2196F3"
      },
      "width": 2,
      "dashes": false,
      "smooth": {
        "type": "continuous"
      }
    },
    {
      "from": "thinking_c31f74ae",
      "to": "action_execution_c71c2e23",
      "label": "executes",
      "arrows": "to",
      "font": {
        "size": 10
      },
      "color": {
        "color": "#3F51B5"
      },
      "width": 3,
      "dashes": false,
      "smooth": {
        "type": "continuous"
      }
    },
    {
      "from": "action_execution_c71c2e23",
      "to": "action_execution_2426aab8",
      "label": "executes",
      "arrows": "to",
      "font": {
        "size": 10
      },
      "color": {
        "color": "#3F51B5"
      },
      "width": 3,
      "dashes": false,
      "smooth": {
        "type": "continuous"
      }
    },
    {
      "from": "action_execution_2426aab8",
      "to": "logical_inference_3a30288b",
      "label": "infers",
      "arrows": "to",
      "font": {
        "size": 10
      },
      "color": {
        "color": "#607D8B"
      },
      "width": 3,
      "dashes": false,
      "smooth": {
        "type": "continuous"
      }
    },
    {
      "from": "logical_inference_3a30288b",
      "to": "error_f4a614d2",
      "label": "encounters error",
      "arrows": "to",
      "font": {
        "size": 10
      },
      "color": {
        "color": "#F44336"
      },
      "width": 2,
      "dashes": [
        3,
        3
      ],
      "smooth": {
        "type": "continuous"
      }
    },
    {
      "from": "error_f4a614d2",
      "to": "action_execution_2268839e",
      "label": "executes",
      "arrows": "to",
      "font": {
        "size": 10
      },
      "color": {
        "color": "#3F51B5"
      },
      "width": 3,
      "dashes": false,
      "smooth": {
        "type": "continuous"
      }
    },
    {
      "from": "action_execution_2268839e",
      "to": "logical_inference_e2655c0d",
      "label": "infers",
      "arrows": "to",
      "font": {
        "size": 10
      },
      "color": {
        "color": "#607D8B"
      },
      "width": 3,
      "dashes": false,
      "smooth": {
        "type": "continuous"
      }
    },
    {
      "from": "logical_inference_e2655c0d",
      "to": "action_execution_90b6aba9",
      "label": "executes",
      "arrows": "to",
      "font": {
        "size": 10
      },
      "color": {
        "color": "#3F51B5"
      },
      "width": 3,
      "dashes": false,
      "smooth": {
        "type": "continuous"
      }
    },
    {
      "from": "action_execution_90b6aba9",
      "to": "logical_inference_98a1b03c",
      "label": "infers",
      "arrows": "to",
      "font": {
        "size": 10
      },
      "color": {
        "color": "#607D8B"
      },
      "width": 3,
      "dashes": false,
      "smooth": {
        "type": "continuous"
      }
    },
    {
      "from": "logical_inference_98a1b03c",
      "to": "thinking_f0741344",
      "label": "thinks",
      "arrows": "to",
      "font": {
        "size": 10
      },
      "color": {
        "color": "#2196F3"
      },
      "width": 2,
      "dashes": false,
      "smooth": {
        "type": "continuous"
      }
    },
    {
      "from": "thinking_f0741344",
      "to": "final_response_be8a8e6d",
      "label": "produces",
      "arrows": "to",
      "font": {
        "size": 10
      },
      "color": {
        "color": "#4CAF50"
      },
      "width": 3,
      "dashes": false,
      "smooth": {
        "type": "continuous"
      }
    }
  ],
  "metadata": {
    "query_id": "query_1750575476_b7e08b3f",
    "generated_at": "2025-06-22T02:06:53.342102",
    "total_nodes": 15,
    "total_edges": 14,
    "execution_time": 536.463754
  },
  "nodeDetails": {
    "query_start_0ccadcbb": {
      "basic_info": {
        "id": "query_start_0ccadcbb",
        "type": "query_start",
        "title": "Query Received",
        "status": "in_progress",
        "description": "Initial query: Why hasn't order 1005 been delivered yet? Check the status and compare with similar orders from the ..."
      },
      "timing": {
        "start_time": "01:57:56.878",
        "end_time": "N/A",
        "execution_time": "N/A"
      },
      "relationships": {
        "parents": 0,
        "children": 1,
        "parent_ids": [],
        "child_ids": [
          "thinking_834c33e4"
        ]
      },
      "data": {
        "input_summary": "Dict with 1 keys: ['query']",
        "output_summary": "No output data",
        "metadata_count": 0
      }
    },
    "thinking_834c33e4": {
      "basic_info": {
        "id": "thinking_834c33e4",
        "type": "thinking",
        "title": "AI Thinking Process",
        "status": "in_progress",
        "description": "Reasoning: Customer service agent received query: Why hasn't order 1005 been delivered yet? Check the status and compare with similar orders from the same timefr..."
      },
      "timing": {
        "start_time": "01:57:56.878",
        "end_time": "N/A",
        "execution_time": "N/A"
      },
      "relationships": {
        "parents": 1,
        "children": 1,
        "parent_ids": [
          "query_start_0ccadcbb"
        ],
        "child_ids": [
          "thinking_becab4f7"
        ]
      },
      "data": {
        "input_summary": "Dict with 2 keys: ['thought', 'context']",
        "output_summary": "No output data",
        "metadata_count": 0
      }
    },
    "thinking_becab4f7": {
      "basic_info": {
        "id": "thinking_becab4f7",
        "type": "thinking",
        "title": "AI Thinking Process",
        "status": "in_progress",
        "description": "Reasoning: Received customer query, initializing response process"
      },
      "timing": {
        "start_time": "01:57:56.878",
        "end_time": "N/A",
        "execution_time": "N/A"
      },
      "relationships": {
        "parents": 1,
        "children": 1,
        "parent_ids": [
          "thinking_834c33e4"
        ],
        "child_ids": [
          "thinking_de2407fe"
        ]
      },
      "data": {
        "input_summary": "Dict with 2 keys: ['thought', 'context']",
        "output_summary": "No output data",
        "metadata_count": 0
      }
    },
    "thinking_de2407fe": {
      "basic_info": {
        "id": "thinking_de2407fe",
        "type": "thinking",
        "title": "AI Thinking Process",
        "status": "in_progress",
        "description": "Reasoning: Evaluating 16 available tools for this query"
      },
      "timing": {
        "start_time": "01:57:56.878",
        "end_time": "N/A",
        "execution_time": "N/A"
      },
      "relationships": {
        "parents": 1,
        "children": 1,
        "parent_ids": [
          "thinking_becab4f7"
        ],
        "child_ids": [
          "thinking_c31f74ae"
        ]
      },
      "data": {
        "input_summary": "Dict with 2 keys: ['thought', 'context']",
        "output_summary": "No output data",
        "metadata_count": 0
      }
    },
    "thinking_c31f74ae": {
      "basic_info": {
        "id": "thinking_c31f74ae",
        "type": "thinking",
        "title": "AI Thinking Process",
        "status": "in_progress",
        "description": "Reasoning: Executing main agent query processing"
      },
      "timing": {
        "start_time": "01:57:56.879",
        "end_time": "N/A",
        "execution_time": "N/A"
      },
      "relationships": {
        "parents": 1,
        "children": 1,
        "parent_ids": [
          "thinking_de2407fe"
        ],
        "child_ids": [
          "action_execution_c71c2e23"
        ]
      },
      "data": {
        "input_summary": "Dict with 2 keys: ['thought', 'context']",
        "output_summary": "No output data",
        "metadata_count": 0
      }
    },
    "action_execution_c71c2e23": {
      "basic_info": {
        "id": "action_execution_c71c2e23",
        "type": "action_execution",
        "title": "Execute: get_delivery_date",
        "status": "completed",
        "description": "Running get_delivery_date with parameters: {'args': '()', 'kwargs': '{}'}"
      },
      "timing": {
        "start_time": "01:58:32.723",
        "end_time": "01:58:32.809",
        "execution_time": "0.087s"
      },
      "relationships": {
        "parents": 1,
        "children": 1,
        "parent_ids": [
          "thinking_c31f74ae"
        ],
        "child_ids": [
          "action_execution_2426aab8"
        ]
      },
      "data": {
        "input_summary": "Dict with 3 keys: ['action_name', 'parameters', 'cached']",
        "output_summary": "Dict with 2 keys: ['result', 'success']",
        "metadata_count": 0
      }
    },
    "action_execution_2426aab8": {
      "basic_info": {
        "id": "action_execution_2426aab8",
        "type": "action_execution",
        "title": "Execute: analyze_orders_by_status_and_timeframe",
        "status": "completed",
        "description": "Running analyze_orders_by_status_and_timeframe with parameters: {'args': \"('16-Jun',)\", 'kwargs': '{}'}"
      },
      "timing": {
        "start_time": "01:58:43.599",
        "end_time": "01:58:43.602",
        "execution_time": "0.003s"
      },
      "relationships": {
        "parents": 1,
        "children": 1,
        "parent_ids": [
          "action_execution_c71c2e23"
        ],
        "child_ids": [
          "logical_inference_3a30288b"
        ]
      },
      "data": {
        "input_summary": "Dict with 3 keys: ['action_name', 'parameters', 'cached']",
        "output_summary": "Dict with 2 keys: ['result', 'success']",
        "metadata_count": 0
      }
    },
    "logical_inference_3a30288b": {
      "basic_info": {
        "id": "logical_inference_3a30288b",
        "type": "logical_inference",
        "title": "Logical Inference",
        "status": "completed",
        "description": "Reasoning: Tool analyze_orders_by_status_and_timeframe executed successfully"
      },
      "timing": {
        "start_time": "01:58:43.602",
        "end_time": "01:58:43.602",
        "execution_time": "0.000s"
      },
      "relationships": {
        "parents": 1,
        "children": 1,
        "parent_ids": [
          "action_execution_2426aab8"
        ],
        "child_ids": [
          "error_f4a614d2"
        ]
      },
      "data": {
        "input_summary": "Dict with 3 keys: ['reasoning', 'evidence', 'conclusion']",
        "output_summary": "Dict with 1 keys: ['conclusion']",
        "metadata_count": 0
      }
    },
    "error_f4a614d2": {
      "basic_info": {
        "id": "error_f4a614d2",
        "type": "error",
        "title": "Error: timeout",
        "status": "failed",
        "description": "Error occurred: Query execution timeout"
      },
      "timing": {
        "start_time": "01:58:56.882",
        "end_time": "01:58:56.882",
        "execution_time": "0.000s"
      },
      "relationships": {
        "parents": 1,
        "children": 1,
        "parent_ids": [
          "logical_inference_3a30288b"
        ],
        "child_ids": [
          "action_execution_2268839e"
        ]
      },
      "data": {
        "input_summary": "Dict with 2 keys: ['error_message', 'error_type']",
        "output_summary": "Dict with 1 keys: ['error']",
        "metadata_count": 0
      }
    },
    "action_execution_2268839e": {
      "basic_info": {
        "id": "action_execution_2268839e",
        "type": "action_execution",
        "title": "Execute: get_order_details",
        "status": "completed",
        "description": "Running get_order_details with parameters: {'args': '()', 'kwargs': '{}'}"
      },
      "timing": {
        "start_time": "01:59:51.872",
        "end_time": "01:59:51.879",
        "execution_time": "0.007s"
      },
      "relationships": {
        "parents": 1,
        "children": 1,
        "parent_ids": [
          "error_f4a614d2"
        ],
        "child_ids": [
          "logical_inference_e2655c0d"
        ]
      },
      "data": {
        "input_summary": "Dict with 3 keys: ['action_name', 'parameters', 'cached']",
        "output_summary": "Dict with 2 keys: ['result', 'success']",
        "metadata_count": 0
      }
    },
    "logical_inference_e2655c0d": {
      "basic_info": {
        "id": "logical_inference_e2655c0d",
        "type": "logical_inference",
        "title": "Logical Inference",
        "status": "completed",
        "description": "Reasoning: Tool get_order_details executed successfully"
      },
      "timing": {
        "start_time": "01:59:51.879",
        "end_time": "01:59:51.879",
        "execution_time": "0.000s"
      },
      "relationships": {
        "parents": 1,
        "children": 1,
        "parent_ids": [
          "action_execution_2268839e"
        ],
        "child_ids": [
          "action_execution_90b6aba9"
        ]
      },
      "data": {
        "input_summary": "Dict with 3 keys: ['reasoning', 'evidence', 'conclusion']",
        "output_summary": "Dict with 1 keys: ['conclusion']",
        "metadata_count": 0
      }
    },
    "action_execution_90b6aba9": {
      "basic_info": {
        "id": "action_execution_90b6aba9",
        "type": "action_execution",
        "title": "Execute: get_order_items",
        "status": "completed",
        "description": "Running get_order_items with parameters: {'args': '()', 'kwargs': '{}'}"
      },
      "timing": {
        "start_time": "02:06:18.788",
        "end_time": "02:06:18.795",
        "execution_time": "0.008s"
      },
      "relationships": {
        "parents": 1,
        "children": 1,
        "parent_ids": [
          "logical_inference_e2655c0d"
        ],
        "child_ids": [
          "logical_inference_98a1b03c"
        ]
      },
      "data": {
        "input_summary": "Dict with 3 keys: ['action_name', 'parameters', 'cached']",
        "output_summary": "Dict with 2 keys: ['result', 'success']",
        "metadata_count": 0
      }
    },
    "logical_inference_98a1b03c": {
      "basic_info": {
        "id": "logical_inference_98a1b03c",
        "type": "logical_inference",
        "title": "Logical Inference",
        "status": "completed",
        "description": "Reasoning: Tool get_order_items returned 1 items"
      },
      "timing": {
        "start_time": "02:06:18.796",
        "end_time": "02:06:18.796",
        "execution_time": "0.000s"
      },
      "relationships": {
        "parents": 1,
        "children": 1,
        "parent_ids": [
          "action_execution_90b6aba9"
        ],
        "child_ids": [
          "thinking_f0741344"
        ]
      },
      "data": {
        "input_summary": "Dict with 3 keys: ['reasoning', 'evidence', 'conclusion']",
        "output_summary": "Dict with 1 keys: ['conclusion']",
        "metadata_count": 0
      }
    },
    "thinking_f0741344": {
      "basic_info": {
        "id": "thinking_f0741344",
        "type": "thinking",
        "title": "AI Thinking Process",
        "status": "in_progress",
        "description": "Reasoning: Query processing completed successfully"
      },
      "timing": {
        "start_time": "02:06:53.341",
        "end_time": "N/A",
        "execution_time": "N/A"
      },
      "relationships": {
        "parents": 1,
        "children": 1,
        "parent_ids": [
          "logical_inference_98a1b03c"
        ],
        "child_ids": [
          "final_response_be8a8e6d"
        ]
      },
      "data": {
        "input_summary": "Dict with 2 keys: ['thought', 'context']",
        "output_summary": "No output data",
        "metadata_count": 0
      }
    },
    "final_response_be8a8e6d": {
      "basic_info": {
        "id": "final_response_be8a8e6d",
        "type": "final_response",
        "title": "Final Response",
        "status": "completed",
        "description": "Query completed: The reason why order 1005 has not been delivered yet could be due to delays in processing caused by ..."
      },
      "timing": {
        "start_time": "02:06:53.342",
        "end_time": "02:06:53.342",
        "execution_time": "0.000s"
      },
      "relationships": {
        "parents": 1,
        "children": 0,
        "parent_ids": [
          "thinking_f0741344"
        ],
        "child_ids": []
      },
      "data": {
        "input_summary": "Dict with 2 keys: ['response', 'success']",
        "output_summary": "Dict with 1 keys: ['final_response']",
        "metadata_count": 0
      }
    }
  },
  "shadowNodes": {
    "thinking_834c33e4": [
      {
        "id": "shadow_thought_thinking_834c33e4",
        "label": "\ud83d\udcad Thought Process",
        "details": "Main thought: Customer service agent received query: Why hasn't order 1005 been delivered yet? Check the status and compare with similar orders from the same timefr...",
        "type": "thought",
        "parent": "thinking_834c33e4"
      },
      {
        "id": "shadow_context_thinking_834c33e4",
        "label": "\ud83e\udde0 Context Analysis",
        "details": "Context: Agent type: CustomerServiceAgent, preparing to process customer inquiry...",
        "type": "context",
        "parent": "thinking_834c33e4"
      }
    ],
    "thinking_becab4f7": [
      {
        "id": "shadow_thought_thinking_becab4f7",
        "label": "\ud83d\udcad Thought Process",
        "details": "Main thought: Received customer query, initializing response process...",
        "type": "thought",
        "parent": "thinking_becab4f7"
      },
      {
        "id": "shadow_context_thinking_becab4f7",
        "label": "\ud83e\udde0 Context Analysis",
        "details": "Context: Query length: 114 characters, analyzing requirements...",
        "type": "context",
        "parent": "thinking_becab4f7"
      }
    ],
    "thinking_de2407fe": [
      {
        "id": "shadow_thought_thinking_de2407fe",
        "label": "\ud83d\udcad Thought Process",
        "details": "Main thought: Evaluating 16 available tools for this query...",
        "type": "thought",
        "parent": "thinking_de2407fe"
      },
      {
        "id": "shadow_context_thinking_de2407fe",
        "label": "\ud83e\udde0 Context Analysis",
        "details": "Context: Analyzing query context: Why hasn't order 1005 been delivered yet? Check the status and compare with similar orders from the ......",
        "type": "context",
        "parent": "thinking_de2407fe"
      }
    ],
    "thinking_c31f74ae": [
      {
        "id": "shadow_thought_thinking_c31f74ae",
        "label": "\ud83d\udcad Thought Process",
        "details": "Main thought: Executing main agent query processing...",
        "type": "thought",
        "parent": "thinking_c31f74ae"
      },
      {
        "id": "shadow_context_thinking_c31f74ae",
        "label": "\ud83e\udde0 Context Analysis",
        "details": "Context: Agent will now process the query using available tools and knowledge...",
        "type": "context",
        "parent": "thinking_c31f74ae"
      }
    ],
    "action_execution_c71c2e23": [
      {
        "id": "shadow_action_action_execution_c71c2e23",
        "label": "\u26a1 get_delivery_date",
        "details": "Action: get_delivery_date",
        "type": "action",
        "parent": "action_execution_c71c2e23"
      },
      {
        "id": "shadow_params_action_execution_c71c2e23",
        "label": "\ud83d\udcdd Parameters",
        "details": "Input params: {'args': '()', 'kwargs': '{}'}...",
        "type": "parameters",
        "parent": "action_execution_c71c2e23"
      },
      {
        "id": "shadow_result_action_execution_c71c2e23",
        "label": "\ud83d\udcca Result",
        "details": "Output: 15-Jun...",
        "type": "result",
        "parent": "action_execution_c71c2e23"
      }
    ],
    "action_execution_2426aab8": [
      {
        "id": "shadow_action_action_execution_2426aab8",
        "label": "\u26a1 analyze_orders_by_status_and_timeframe",
        "details": "Action: analyze_orders_by_status_and_timeframe",
        "type": "action",
        "parent": "action_execution_2426aab8"
      },
      {
        "id": "shadow_params_action_execution_2426aab8",
        "label": "\ud83d\udcdd Parameters",
        "details": "Input params: {'args': \"('16-Jun',)\", 'kwargs': '{}'}...",
        "type": "parameters",
        "parent": "action_execution_2426aab8"
      },
      {
        "id": "shadow_result_action_execution_2426aab8",
        "label": "\ud83d\udcca Result",
        "details": "Output: {'timeframe': '14-Jun to 16-Jun', 'status_breakdown': [], 'total_orders': 0, 'total_revenue': 0, 'pe...",
        "type": "result",
        "parent": "action_execution_2426aab8"
      }
    ],
    "logical_inference_3a30288b": [
      {
        "id": "shadow_reasoning_logical_inference_3a30288b",
        "label": "\ud83e\udd14 Reasoning",
        "details": "Logic: Tool analyze_orders_by_status_and_timeframe executed successfully...",
        "type": "reasoning",
        "parent": "logical_inference_3a30288b"
      },
      {
        "id": "shadow_evidence_logical_inference_3a30288b",
        "label": "\ud83d\udccb Evidence",
        "details": "Evidence points: 1 items",
        "type": "evidence",
        "parent": "logical_inference_3a30288b"
      },
      {
        "id": "shadow_conclusion_logical_inference_3a30288b",
        "label": "\u2705 Conclusion",
        "details": "Result: Retrieved valid data: {'timeframe': '14-Jun to 16-Jun', 'status_breakdown': [], 'total_orders': 0, 'total_revenue': 0, 'pe......",
        "type": "conclusion",
        "parent": "logical_inference_3a30288b"
      }
    ],
    "action_execution_2268839e": [
      {
        "id": "shadow_action_action_execution_2268839e",
        "label": "\u26a1 get_order_details",
        "details": "Action: get_order_details",
        "type": "action",
        "parent": "action_execution_2268839e"
      },
      {
        "id": "shadow_params_action_execution_2268839e",
        "label": "\ud83d\udcdd Parameters",
        "details": "Input params: {'args': '()', 'kwargs': '{}'}...",
        "type": "parameters",
        "parent": "action_execution_2268839e"
      },
      {
        "id": "shadow_result_action_execution_2268839e",
        "label": "\ud83d\udcca Result",
        "details": "Output: {'order_id': 1005, 'order_date': datetime.date(2024, 6, 10), 'delivery_date': datetime.date(2024, 6,...",
        "type": "result",
        "parent": "action_execution_2268839e"
      }
    ],
    "logical_inference_e2655c0d": [
      {
        "id": "shadow_reasoning_logical_inference_e2655c0d",
        "label": "\ud83e\udd14 Reasoning",
        "details": "Logic: Tool get_order_details executed successfully...",
        "type": "reasoning",
        "parent": "logical_inference_e2655c0d"
      },
      {
        "id": "shadow_evidence_logical_inference_e2655c0d",
        "label": "\ud83d\udccb Evidence",
        "details": "Evidence points: 1 items",
        "type": "evidence",
        "parent": "logical_inference_e2655c0d"
      },
      {
        "id": "shadow_conclusion_logical_inference_e2655c0d",
        "label": "\u2705 Conclusion",
        "details": "Result: Retrieved valid data: {'order_id': 1005, 'order_date': datetime.date(2024, 6, 10), 'delivery_date': datetime.date(2024, 6,......",
        "type": "conclusion",
        "parent": "logical_inference_e2655c0d"
      }
    ],
    "action_execution_90b6aba9": [
      {
        "id": "shadow_action_action_execution_90b6aba9",
        "label": "\u26a1 get_order_items",
        "details": "Action: get_order_items",
        "type": "action",
        "parent": "action_execution_90b6aba9"
      },
      {
        "id": "shadow_params_action_execution_90b6aba9",
        "label": "\ud83d\udcdd Parameters",
        "details": "Input params: {'args': '()', 'kwargs': '{}'}...",
        "type": "parameters",
        "parent": "action_execution_90b6aba9"
      },
      {
        "id": "shadow_result_action_execution_90b6aba9",
        "label": "\ud83d\udcca Result",
        "details": "Output: ['Gaming Monitor 32\" ASUS']...",
        "type": "result",
        "parent": "action_execution_90b6aba9"
      }
    ],
    "logical_inference_98a1b03c": [
      {
        "id": "shadow_reasoning_logical_inference_98a1b03c",
        "label": "\ud83e\udd14 Reasoning",
        "details": "Logic: Tool get_order_items returned 1 items...",
        "type": "reasoning",
        "parent": "logical_inference_98a1b03c"
      },
      {
        "id": "shadow_evidence_logical_inference_98a1b03c",
        "label": "\ud83d\udccb Evidence",
        "details": "Evidence points: 1 items",
        "type": "evidence",
        "parent": "logical_inference_98a1b03c"
      },
      {
        "id": "shadow_conclusion_logical_inference_98a1b03c",
        "label": "\u2705 Conclusion",
        "details": "Result: Successfully retrieved 1 records...",
        "type": "conclusion",
        "parent": "logical_inference_98a1b03c"
      }
    ],
    "thinking_f0741344": [
      {
        "id": "shadow_thought_thinking_f0741344",
        "label": "\ud83d\udcad Thought Process",
        "details": "Main thought: Query processing completed successfully...",
        "type": "thought",
        "parent": "thinking_f0741344"
      },
      {
        "id": "shadow_context_thinking_f0741344",
        "label": "\ud83e\udde0 Context Analysis",
        "details": "Context: Generated response of 358 characters...",
        "type": "context",
        "parent": "thinking_f0741344"
      }
    ]
  },
  "queryResponse": {
    "query": "Why hasn't order 1005 been delivered yet? Check the status and compare with similar orders from the same timeframe",
    "response": "The reason why order 1005 has not been delivered yet could be due to delays in processing caused by high demand or supply chain disruptions for the Gaming Monitor 32\" ASUS, as there are no system-wide issues and the order is still in processing status. I recommend checking with the customer service ..."
  }
};
        
        // Create network
        const container = document.getElementById('network');
        
        const options = {
            layout: {
                hierarchical: {
                    enabled: true,
                    direction: 'UD',
                    sortMethod: 'directed',
                    levelSeparation: 100,
                    nodeSpacing: 150
                }
            },
            physics: {
                enabled: true,
                hierarchicalRepulsion: {
                    centralGravity: 0.0,
                    springLength: 100,
                    springConstant: 0.01,
                    nodeDistance: 120,
                    damping: 0.09
                }
            },
            nodes: {
                font: { size: 10, color: '#333' },
                borderWidth: 2,
                shadow: true,
                chosen: true,
                size: 20,
                scaling: {
                    min: 15,
                    max: 30
                },
                widthConstraint: {
                    minimum: 80,
                    maximum: 120
                }
            },
            edges: {
                font: { size: 10, color: '#333' },
                width: 2,
                shadow: true,
                smooth: {
                    type: 'continuous'
                }
            },
            interaction: {
                hover: true,
                tooltipDelay: 300,
                hideEdgesOnDrag: false,
                hideNodesOnDrag: false
            }
        };
        
        const network = new vis.Network(container, graphData, options);
        
        // Store original node data for highlighting
        let originalNodeData = JSON.parse(JSON.stringify(graphData.nodes));
        let isHighlighted = false;
        
        // Shadow node tracking variables
        let activeShadowNodes = [];
        let activeShadowEdges = [];
        
        // Event listeners
        network.on("click", function(params) {
            if (params.nodes.length > 0) {
                const nodeId = params.nodes[0];
                
                // Check if it's a shadow node (ignore clicks on shadow nodes)
                if (nodeId.startsWith('shadow_')) {
                    return;
                }
                
                const node = graphData.nodes.find(n => n.id === nodeId);
                showNodeDetails(node);
            } else {
                // Clicked on empty space, clear shadow nodes
                clearShadowNodes();
                document.getElementById('node-info').innerHTML = 'Click on a node to see comprehensive detailed information';
            }
        });
        
        network.on("hoverNode", function(params) {
            container.style.cursor = 'pointer';
        });
        
        network.on("blurNode", function(params) {
            container.style.cursor = 'default';
        });
        
        // Control functions
        function fitNetwork() {
            network.fit();
        }
        
        let physicsEnabled = true;
        function togglePhysics() {
            physicsEnabled = !physicsEnabled;
            network.setOptions({physics: {enabled: physicsEnabled}});
        }
        
        function exportImage() {
            const canvas = container.querySelector('canvas');
            if (canvas) {
                const link = document.createElement('a');
                link.download = 'enhanced_query_execution_graph.png';
                link.href = canvas.toDataURL();
                link.click();
            } else {
                alert('Canvas not found. Please try again.');
            }
        }
        
        function togglePseudocode() {
            const content = document.getElementById('pseudocode-content');
            const button = document.querySelector('.toggle-pseudocode');
    
            if (content.style.display === 'none') {
                content.style.display = 'block';
                button.textContent = '📖 Hide Algorithm Details';
            } else {
                content.style.display = 'none';
                button.textContent = '📖 Show Algorithm Details';
            }
        }
        
        function highlightActions() {
            // Clear shadow nodes first to avoid conflicts
            clearShadowNodes();
            
            // Toggle highlight state
            isHighlighted = !isHighlighted;
            
            if (isHighlighted) {
                // Highlight action-related nodes
                const updatedNodes = graphData.nodes.map(node => {
                    const isActionNode = node.shape === 'triangleDown' || 
                                       node.shape === 'square' || 
                                       node.shape === 'circle';
                    
                    if (isActionNode) {
                        return {
                            ...node,
                            borderWidth: 6,
                            color: {
                                ...node.color,
                                border: '#FF5722'
                            },
                            font: {
                                ...node.font,
                                size: 14,
                                color: '#FF5722'
                            }
                        };
                    } else {
                        return {
                            ...node,
                            color: {
                                ...node.color,
                                background: '#E0E0E0'
                            }
                        };
                    }
                });
                
                // Update the network with highlighted nodes
                network.setData({
                    nodes: updatedNodes,
                    edges: graphData.edges
                });
                
                alert('Action nodes highlighted! Click again to reset.');
            } else {
                // Reset to original appearance
                network.setData({
                    nodes: originalNodeData,
                    edges: graphData.edges
                });
            }
        }
        
        function showStatistics() {
            const stats = calculateStatistics();
            const actionNodes = graphData.nodes.filter(n => 
                n.shape === 'triangleDown' || n.shape === 'square' || n.shape === 'circle'
            ).length;
            
            const cacheHits = graphData.nodes.filter(n => n.shape === 'circle').length;
            const errorNodes = graphData.nodes.filter(n => 
                n.color.background === '#F44336'
            ).length;
            
            const message = `📊 Enhanced Graph Statistics:
            
    Total Nodes: ${stats.totalNodes}
    Total Edges: ${stats.totalEdges}
    Action Nodes: ${actionNodes}
    Cache Hits: ${cacheHits}
    Error Nodes: ${errorNodes}
    Average Execution Time: ${stats.avgExecutionTime}s
    Success Rate: ${stats.successRate}%
    Most Common Node Type: ${stats.mostCommonType}`;
            
            alert(message);
        }
        
        function resetView() {
            // Reset highlighting
            isHighlighted = false;
            
            // Clear shadow nodes first
            clearShadowNodes();
            
            // Reset to original data
            network.setData({
                nodes: originalNodeData,
                edges: graphData.edges
            });
            
            // Reset view and physics
            network.fit();
            network.setOptions({physics: {enabled: true}});
            physicsEnabled = true;
        }
        
        function showNodeDetails(node) {
            const infoDiv = document.getElementById('node-info');
            
            if (!node) {
                infoDiv.innerHTML = '<p>No node selected</p>';
                clearShadowNodes();
                return;
            }
            
            // Show shadow nodes for this node
            showShadowNodes(node);
            
            // Get enhanced details from the graph metadata
            const nodeDetails = graphData.nodeDetails[node.id];
            
            if (!nodeDetails) {
                infoDiv.innerHTML = '<p>No detailed information available</p>';
                return;
            }
            
            const details = `
                <div class="node-details">
                    <h4>🔍 ${nodeDetails.basic_info.title}</h4>
                    
                    <div class="detail-section">
                        <h5>📋 Basic Information</h5>
                        <table class="detail-table">
                            <tr><td><strong>Node ID:</strong></td><td>${nodeDetails.basic_info.id}</td></tr>
                            <tr><td><strong>Type:</strong></td><td>${nodeDetails.basic_info.type}</td></tr>
                            <tr><td><strong>Status:</strong></td><td><span class="status-${nodeDetails.basic_info.status}">${nodeDetails.basic_info.status}</span></td></tr>
                        </table>
                        <p><strong>Description:</strong> ${nodeDetails.basic_info.description}</p>
                    </div>
                    
                    <div class="detail-section">
                        <h5>⏱️ Timing Information</h5>
                        <table class="detail-table">
                            <tr><td><strong>Start Time:</strong></td><td>${nodeDetails.timing.start_time}</td></tr>
                            <tr><td><strong>End Time:</strong></td><td>${nodeDetails.timing.end_time}</td></tr>
                            <tr><td><strong>Execution Time:</strong></td><td>${nodeDetails.timing.execution_time}</td></tr>
                        </table>
                    </div>
                    
                    <div class="detail-section">
                        <h5>🔗 Relationships</h5>
                        <table class="detail-table">
                            <tr><td><strong>Parent Nodes:</strong></td><td>${nodeDetails.relationships.parents}</td></tr>
                            <tr><td><strong>Child Nodes:</strong></td><td>${nodeDetails.relationships.children}</td></tr>
                        </table>
                        ${nodeDetails.relationships.parent_ids.length > 0 ? 
                            `<p><strong>Parents:</strong> ${nodeDetails.relationships.parent_ids.join(', ')}</p>` : ''}
                        ${nodeDetails.relationships.child_ids.length > 0 ? 
                            `<p><strong>Children:</strong> ${nodeDetails.relationships.child_ids.join(', ')}</p>` : ''}
                    </div>
                    
                    <div class="detail-section">
                        <h5>📊 Data Information</h5>
                        <p><strong>Input:</strong> ${nodeDetails.data.input_summary}</p>
                        <p><strong>Output:</strong> ${nodeDetails.data.output_summary}</p>
                        <p><strong>Metadata:</strong> ${nodeDetails.data.metadata_count} items</p>
                    </div>
                    
                    <div class="detail-section">
                        <h5>👻 Shadow Details</h5>
                        <p><em>Shadow nodes now visible below showing detailed internal processes.</em></p>
                    </div>
                </div>
            `;
            
            infoDiv.innerHTML = details;
        }
        
        function showShadowNodes(node) {
            // Clear existing shadow nodes
            clearShadowNodes();
            
            // Get shadow data for this node
            const shadowData = graphData.shadowNodes[node.id];
            if (!shadowData || shadowData.length === 0) {
                return;
            }
            
            // Get the position of the main node
            const nodePosition = network.getPositions([node.id]);
            const mainNodePos = nodePosition[node.id];
            
            // Create shadow nodes
            shadowData.forEach((shadowInfo, index) => {
                const shadowNode = {
                    id: shadowInfo.id,
                    label: shadowInfo.label,
                    title: shadowInfo.details,
                    x: mainNodePos.x + (index - shadowData.length/2) * 80,
                    y: mainNodePos.y + 120,
                    color: {
                        background: 'rgba(255,255,255,0.9)',
                        border: '#666',
                        highlight: {
                            background: 'rgba(255,255,255,1)',
                            border: '#333'
                        }
                    },
                    shape: 'box',
                    font: { size: 9, color: '#333', italic: true },
                    size: 15,
                    borderWidth: 2,
                    borderWidthSelected: 3,
                    chosen: false,
                    physics: false,
                    opacity: 0.7
                };
                
                activeShadowNodes.push(shadowNode);
                
                // Create edge from main node to shadow node
                const shadowEdge = {
                    id: `edge_${node.id}_to_${shadowInfo.id}`,
                    from: node.id,
                    to: shadowInfo.id,
                    color: { color: '#999', opacity: 0.5 },
                    width: 1,
                    dashes: [5, 5],
                    arrows: 'to',
                    physics: false
                };
                
                activeShadowEdges.push(shadowEdge);
            });
            
            // CORRECTED: Use proper vis.js API - add nodes and edges to existing dataset
            const currentNodes = graphData.nodes.slice(); // Create a copy
            const currentEdges = graphData.edges.slice(); // Create a copy
            
            // Add shadow nodes and edges
            const newNodes = currentNodes.concat(activeShadowNodes);
            const newEdges = currentEdges.concat(activeShadowEdges);
            
            // Update the network with new data
            network.setData({ nodes: newNodes, edges: newEdges });
        }
        
        function clearShadowNodes() {
            if (activeShadowNodes.length === 0 && activeShadowEdges.length === 0) {
                return;
            }
            
            // CORRECTED: Reset to original data instead of using getData()
            network.setData({ 
                nodes: graphData.nodes, 
                edges: graphData.edges 
            });
            
            // Clear the arrays
            activeShadowNodes = [];
            activeShadowEdges = [];
        }
        
        function calculateStatistics() {
            const totalNodes = graphData.nodes.length;
            const totalEdges = graphData.edges.length;
            
            // Calculate node type distribution
            const shapeCount = {};
            graphData.nodes.forEach(node => {
                const shape = node.shape;
                shapeCount[shape] = (shapeCount[shape] || 0) + 1;
            });
            
            const mostCommonShape = Object.keys(shapeCount).reduce((a, b) => 
                shapeCount[a] > shapeCount[b] ? a : b
            );
            
            // Calculate success rate (nodes without error color)
            const errorNodes = graphData.nodes.filter(n => 
                n.color.background === '#F44336'
            ).length;
            const successRate = ((totalNodes - errorNodes) / totalNodes * 100).toFixed(1);
            
            return {
                totalNodes,
                totalEdges,
                avgExecutionTime: 536.464,
                successRate,
                mostCommonType: mostCommonShape
            };
        }
        
        // Initialize
        fitNetwork();
        
        // Add keyboard shortcuts
        document.addEventListener('keydown', function(event) {
            switch(event.key) {
                case 'f':
                case 'F':
                    if (event.ctrlKey || event.metaKey) {
                        event.preventDefault();
                        fitNetwork();
                    }
                    break;
                case 'h':
                case 'H':
                    if (event.ctrlKey || event.metaKey) {
                        event.preventDefault();
                        highlightActions();
                    }
                    break;
                case 'r':
                case 'R':
                    if (event.ctrlKey || event.metaKey) {
                        event.preventDefault();
                        resetView();
                    }
                    break;
            }
        });
    </script>
</body>
</html>
        